<!DOCTYPE html>
<html>
<head>
  <title>BigCat Mine - Tugas Video</title>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <style>
    body { font-family: Arial, sans-serif; background: #f2f2f2; text-align: center; padding: 20px; }
    iframe { width: 100%; max-width: 560px; height: 315px; border: none; margin-top: 20px; border-radius: 12px; }
    .info { margin: 15px auto; font-size: 18px; }
    #rewardBtn {
      padding: 12px 24px;
      font-size: 16px;
      background-color: #28a745;
      color: white;
      border: none;
      border-radius: 8px;
      cursor: pointer;
      margin-top: 15px;
    }
    #rewardBtn:disabled {
      background-color: #ccc;
      cursor: not-allowed;
    }
  </style>
</head>
<body>

  <h2>üé¨ BigCat Mine - Tugas Video</h2>
  <div class="info" id="status">Memuat video...</div>
  <iframe id="player" allow="autoplay; encrypted-media" allowfullscreen></iframe>
  <div class="info" id="countdown">‚è≥ 60 detik</div>
  <button id="rewardBtn" disabled>‚úÖ Dapatkan Reward</button>

  <script>
    const videos = [
      "dQw4w9WgXcQ", "kJQP7kiw5Fk", "3tmd-ClpJxA", "tgbNymZ7vqY",
      "V-_O7nl0Ii0", "fdPVcHr6etE", "7QUtEmBT_-w", "CdX6euCZ5Bo",
      "LsoLEjrDogU", "9bZkp7q19f0"
    ];

    let currentIndex = 0;
    let countdown = 60;
    let reward = getRandomReward();
    let interval;
    let player;

    const iframe = document.getElementById("player");
    const countdownEl = document.getElementById("countdown");
    const statusEl = document.getElementById("status");
    const rewardBtn = document.getElementById("rewardBtn");

    function loadYouTubeAPI() {
      const tag = document.createElement("script");
      tag.src = "https://www.youtube.com/iframe_api";
      const firstScript = document.getElementsByTagName("script")[0];
      firstScript.parentNode.insertBefore(tag, firstScript);
    }

    window.onYouTubeIframeAPIReady = function() {
      player = new YT.Player("player", {
        videoId: videos[currentIndex],
        playerVars: { autoplay: 1, controls: 1, mute: 1 },
        events: {
          'onReady': startCountdown,
          'onStateChange': onPlayerStateChange
        }
      });
    };

    function startCountdown() {
      statusEl.textContent = `üéØ Tonton video selama 60 detik untuk dapat Rp${reward}`;
      countdown = 60;
      rewardBtn.disabled = true;

      interval = setInterval(() => {
        if (player && player.getPlayerState() === YT.PlayerState.PLAYING) {
          countdown--;
          countdownEl.textContent = `‚è≥ ${countdown} detik`;
          if (countdown <= 0) {
            clearInterval(interval);
            rewardBtn.disabled = false;
            countdownEl.textContent = "‚úÖ Selesai! Klik untuk klaim.";
            statusEl.textContent = `Kamu mendapatkan Rp${reward}`;
          }
        }
      }, 1000);
    }

    function onPlayerStateChange(event) {
      if (event.data === YT.PlayerState.PAUSED || event.data === YT.PlayerState.ENDED) {
        clearInterval(interval);
      } else if (event.data === YT.PlayerState.PLAYING && countdown > 0) {
        clearInterval(interval); // restart interval to avoid duplicates
        startCountdown();
      }
    }

    rewardBtn.onclick = () => {
      alert(`üéâ Selamat! Kamu dapat Rp${reward}`);
      rewardBtn.disabled = true;
      nextVideo();
    };

    function nextVideo() {
      currentIndex++;
      if (currentIndex < videos.length) {
        reward = getRandomReward();
        countdown = 60;
        countdownEl.textContent = "‚è≥ 60 detik";
        player.loadVideoById(videos[currentIndex]);
        statusEl.textContent = "Memuat video berikutnya...";
      } else {
        statusEl.textContent = "üéâ Semua tugas selesai!";
        countdownEl.textContent = "";
        rewardBtn.style.display = "none";
      }
    }

    function getRandomReward() {
      return Math.floor(Math.random() * 16) + 10; // Rp10 - Rp25
    }

    loadYouTubeAPI();
  </script>

</body>
</html>
